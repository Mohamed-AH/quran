<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø§ÙØ¸ | Quran Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700&family=Rakkas&family=Crimson+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --forest-dark: #0a3a2a;
            --forest-mid: #145a3e;
            --forest-light: #1e7a54;
            --gold: #d4af37;
            --gold-light: #f4d77f;
            --cream: #faf8f3;
            --sage: #8ba888;
            --shadow: rgba(10, 58, 42, 0.3);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, var(--forest-dark) 0%, var(--forest-mid) 50%, var(--forest-light) 100%);
            background-attachment: fixed;
            color: var(--cream);
            min-height: 100vh;
            overflow-x: hidden;
        }
        body[dir="ltr"] { font-family: 'Crimson Pro', serif; }
        .app { max-width: 1400px; margin: 0 auto; padding: 20px; position: relative; z-index: 1; }
        header { text-align: center; padding: 40px 20px; position: relative; }
        .lang-toggle {
            position: absolute; top: 20px; right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(212, 175, 55, 0.3);
            color: var(--cream); padding: 8px 20px;
            border-radius: 50px; cursor: pointer;
            transition: all 0.3s; font-weight: 600;
        }
        body[dir="ltr"] .lang-toggle { left: 20px; right: auto; }
        .lang-toggle:hover { background: rgba(212, 175, 55, 0.2); border-color: var(--gold); }
        .help-btn {
            position: absolute; top: 20px; left: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(212, 175, 55, 0.3);
            color: var(--cream); width: 40px; height: 40px;
            border-radius: 50%; cursor: pointer;
            transition: all 0.3s; font-weight: 700;
            font-size: 1.2rem; display: flex;
            align-items: center; justify-content: center;
        }
        body[dir="ltr"] .help-btn { right: 20px; left: auto; }
        .help-btn:hover { background: var(--gold); color: var(--forest-dark); transform: scale(1.1); }
        h1 {
            font-family: 'Rakkas', cursive;
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        .subtitle { font-family: 'Amiri', serif; font-size: 1.3rem; color: var(--sage); }
        body[dir="ltr"] .subtitle { font-family: 'Crimson Pro', serif; }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px; margin: 40px 0;
        }
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 20px; padding: 25px;
            text-align: center;
            transition: all 0.3s;
        }
        .stat-card:hover { transform: translateY(-5px); border-color: var(--gold); }
        .stat-number { font-size: 2.5rem; font-weight: 700; color: var(--gold); }
        .stat-label { font-size: 0.95rem; color: var(--sage); margin-top: 5px; }
        .progress-ring { width: 120px; height: 120px; margin: 0 auto 20px; }
        .progress-ring-circle {
            transition: stroke-dashoffset 1s ease-out;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        .tabs {
            display: flex; gap: 10px;
            margin: 40px 0 30px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .tab {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.3);
            color: var(--cream);
            padding: 12px 30px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        .tab:hover { background: rgba(212, 175, 55, 0.1); border-color: var(--gold); }
        .tab.active {
            background: var(--gold);
            color: var(--forest-dark);
            border-color: var(--gold);
        }
        .content {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 25px;
            padding: 30px;
        }
        .juz-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .juz-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.2);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .juz-card:hover { transform: scale(1.05); border-color: var(--gold); }
        .juz-card.completed {
            background: linear-gradient(135deg, var(--forest-light) 0%, var(--forest-mid) 100%);
            border-color: var(--gold);
        }
        .juz-number { font-size: 2rem; font-weight: 700; color: var(--gold); }
        .juz-name { font-size: 0.85rem; color: var(--sage); margin-top: 5px; }
        .juz-status { font-size: 0.75rem; color: var(--gold-light); margin-top: 8px; }
        .daily-log {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }
        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .log-date { font-size: 1.3rem; color: var(--gold); font-weight: 600; }
        .input-group { margin-bottom: 20px; }
        label {
            display: block;
            color: var(--sage);
            margin-bottom: 8px;
            font-weight: 600;
        }
        input, textarea, select {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.2);
            border-radius: 10px;
            padding: 12px 15px;
            color: var(--cream);
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        select option {
            background: var(--forest-dark);
            color: var(--cream);
            padding: 10px;
        }
        
        select option:hover,
        select option:focus,
        select option:checked {
            background: var(--forest-mid);
            color: var(--gold);
        }
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--gold);
            background: rgba(255, 255, 255, 0.08);
        }
        textarea { min-height: 80px; resize: vertical; }
        .btn {
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            color: var(--forest-dark);
            border: none;
            padding: 14px 35px;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }
        .btn:hover { transform: translateY(-2px); }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); color: var(--cream); }
        .history-item {
            background: rgba(255, 255, 255, 0.03);
            border-left: 4px solid var(--gold);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        body[dir="ltr"] .history-item { border-left: none; border-right: 4px solid var(--gold); }
        .history-item:hover { background: rgba(255, 255, 255, 0.05); }
        .history-date { color: var(--gold); font-weight: 600; margin-bottom: 10px; }
        .history-content { color: var(--sage); line-height: 1.6; }
        .rating-stars {
            display: flex;
            gap: 5px;
            font-size: 1.5rem;
            justify-content: center;
            margin: 10px 0;
        }
        .star {
            cursor: pointer;
            transition: all 0.2s;
            color: rgba(212, 175, 55, 0.3);
        }
        .star:hover, .star.active { color: var(--gold); transform: scale(1.2); }
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 58, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .modal-content {
            background: var(--forest-dark);
            border: 2px solid var(--gold);
            border-radius: 25px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .modal-title { font-size: 1.8rem; color: var(--gold); font-weight: 700; }
        .close-btn {
            background: none;
            border: none;
            color: var(--cream);
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        .close-btn:hover { color: var(--gold); transform: rotate(90deg); }
        .button-group { display: flex; gap: 15px; margin-top: 25px; flex-wrap: wrap; }
        .empty-state { text-align: center; padding: 60px 20px; color: var(--sage); }
        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); }
            .button-group { flex-direction: column; }
            .btn { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="app">
        <header>
            <button class="lang-toggle" onclick="toggleLanguage()" id="langBtn">English</button>
            <button class="help-btn" onclick="openHelp()">?</button>
            <h1 id="appTitle">Ø­Ø§ÙØ¸</h1>
            <p class="subtitle" id="subtitle">Ø±Ø­Ù„Ø© Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</p>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalPages">0</div>
                <div class="stat-label" id="labelPages">ØµÙØ­Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalJuz">0</div>
                <div class="stat-label" id="labelJuz">Ø£Ø¬Ø²Ø§Ø¡ Ù…ÙƒØªÙ…Ù„Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="currentStreak">0</div>
                <div class="stat-label" id="labelStreak">Ø£ÙŠØ§Ù… Ù…ØªØªØ§Ù„ÙŠØ©</div>
            </div>
            <div class="stat-card">
                <svg class="progress-ring" viewBox="0 0 120 120">
                    <circle cx="60" cy="60" r="54" fill="none" stroke="rgba(212, 175, 55, 0.2)" stroke-width="8"/>
                    <circle id="progressCircle" class="progress-ring-circle" cx="60" cy="60" r="54" fill="none" 
                            stroke="var(--gold)" stroke-width="8" stroke-linecap="round"
                            stroke-dasharray="339.292" stroke-dashoffset="339.292"/>
                    <text x="60" y="60" text-anchor="middle" dy=".3em" fill="var(--gold)" font-size="24" font-weight="700" id="progressPercent">0%</text>
                </svg>
                <div class="stat-label" id="labelProgress">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('today')" id="tabToday">Ø§Ù„ÙŠÙˆÙ…</button>
            <button class="tab" onclick="switchTab('juz')" id="tabJuz">Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡</button>
            <button class="tab" onclick="switchTab('history')" id="tabHistory">Ø§Ù„Ø³Ø¬Ù„</button>
            <button class="tab" onclick="switchTab('stats')" id="tabStats">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
            <button class="tab" onclick="switchTab('profile')" id="tabProfile">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</button>
        </div>

        <div class="content">
            <div id="todayTab">
                <div class="daily-log">
                    <div class="log-header">
                        <div class="log-date" id="currentDate"></div>
                        <button class="btn" onclick="saveLog()" id="btnSave">Ø­ÙØ¸ Ø§Ù„ÙŠÙˆÙ…</button>
                    </div>
                    <div class="input-group">
                        <label id="labelNewPages">Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</label>
                        <input type="text" id="newPages" placeholder="Ù…Ø«Ø§Ù„: 1-3ØŒ 5">
                    </div>
                    <div class="input-group">
                        <label id="labelNewQuality">Ø¬ÙˆØ¯Ø© Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙŠØ¯</label>
                        <div class="rating-stars" id="newRating">
                            <span class="star" onclick="setRating('new', 1)">â˜…</span>
                            <span class="star" onclick="setRating('new', 2)">â˜…</span>
                            <span class="star" onclick="setRating('new', 3)">â˜…</span>
                            <span class="star" onclick="setRating('new', 4)">â˜…</span>
                            <span class="star" onclick="setRating('new', 5)">â˜…</span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label id="labelReviewPages">ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</label>
                        <input type="text" id="reviewPages" placeholder="Ù…Ø«Ø§Ù„: 10-15">
                    </div>
                    <div class="input-group">
                        <label id="labelReviewQuality">Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</label>
                        <div class="rating-stars" id="reviewRating">
                            <span class="star" onclick="setRating('review', 1)">â˜…</span>
                            <span class="star" onclick="setRating('review', 2)">â˜…</span>
                            <span class="star" onclick="setRating('review', 3)">â˜…</span>
                            <span class="star" onclick="setRating('review', 4)">â˜…</span>
                            <span class="star" onclick="setRating('review', 5)">â˜…</span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label id="labelNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ÙŠÙˆÙ…</label>
                        <textarea id="notes" placeholder="Ø¢ÙŠØ§Øª ØµØ¹Ø¨Ø©ØŒ Ø¥Ù†Ø¬Ø§Ø²Ø§ØªØŒ Ø£Ùˆ Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª..."></textarea>
                    </div>
                </div>
            </div>

            <div id="juzTab" style="display:none;">
                <div class="juz-grid" id="juzGrid"></div>
            </div>

            <div id="historyTab" style="display:none;">
                <div id="historyList"></div>
            </div>

            <div id="statsTab" style="display:none;">
                <h2 style="color: var(--gold); margin-bottom: 20px;" id="statsTitle">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…ÙØµÙ„Ø©</h2>
                <div id="detailedStats"></div>
            </div>

            <div id="profileTab" style="display:none;">
                <h2 style="color: var(--gold); margin-bottom: 20px;" id="profileTitle">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</h2>
                <div class="daily-log">
                    <div class="log-header">
                        <div class="log-date" id="currentProfileName">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                    </div>
                    <div class="input-group">
                        <label id="labelProfileSelect">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</label>
                        <select id="profileSelect" onchange="switchProfile()"></select>
                    </div>
                    <div class="input-group">
                        <label id="labelNewProfile">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø´Ø®ØµÙŠ Ø¬Ø¯ÙŠØ¯</label>
                        <input type="text" id="newProfileName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯...">
                    </div>
                    <button class="btn" onclick="createProfile()" id="btnCreateProfile">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù</button>
                    <div style="margin-top: 40px; padding-top: 30px; border-top: 2px solid rgba(212, 175, 55, 0.2);">
                        <h3 style="color: var(--gold); margin-bottom: 20px;" id="profileActionsTitle">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ù„Ù</h3>
                        <div class="button-group">
                            <button class="btn" onclick="exportProfile()" id="btnExport">ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù</button>
                            <button class="btn" onclick="importProfile()" id="btnImport">Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù</button>
                            <button class="btn btn-secondary" onclick="renameProfile()" id="btnRename">Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ©</button>
                            <button class="btn btn-secondary" onclick="deleteProfile()" id="btnDelete" style="background: rgba(220, 53, 69, 0.2); color: #ff6b6b;">Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù</button>
                        </div>
                    </div>
                    <div style="margin-top: 30px; padding: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 15px; border: 1px solid rgba(212, 175, 55, 0.2);">
                        <h4 style="color: var(--gold); margin-bottom: 15px;" id="profileInfoTitle">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù„Ù</h4>
                        <div id="profileInfo" style="color: var(--sage); line-height: 1.8;"></div>
                    </div>
                </div>
            </div>
        </div>

        <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="handleImportFile(event)">
    </div>

    <div class="modal" id="juzModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Ø¬Ø²Ø¡</h2>
                <button class="close-btn" onclick="closeModal()">Ã—</button>
            </div>
            <div class="input-group">
                <label id="labelJuzStatus">Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø²Ø¡</label>
                <select id="juzStatus">
                    <option value="not-started">Ù„Ù… ÙŠØ¨Ø¯Ø£</option>
                    <option value="in-progress">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸</option>
                    <option value="completed">Ù…ÙƒØªÙ…Ù„</option>
                </select>
            </div>
            <div class="input-group">
                <label id="labelJuzPages">Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© (Ù…Ù† 20)</label>
                <input type="number" id="juzPages" min="0" max="20" value="0">
            </div>
            <div class="input-group">
                <label id="labelJuzStart">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡</label>
                <input type="date" id="juzStartDate">
            </div>
            <div class="input-group">
                <label id="labelJuzEnd">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØªÙ…Ø§Ù…</label>
                <input type="date" id="juzEndDate">
            </div>
            <div class="input-group">
                <label id="labelJuzNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                <textarea id="juzNotes" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡..."></textarea>
            </div>
            <div class="button-group">
                <button class="btn" onclick="saveJuz()" id="btnJuzSave">Ø­ÙØ¸</button>
                <button class="btn btn-secondary" onclick="closeModal()" id="btnJuzCancel">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <div class="modal" id="helpModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="helpTitle">ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h2>
                <button class="close-btn" onclick="closeHelp()">Ã—</button>
            </div>
            <div id="helpContent" style="line-height: 1.8; color: var(--cream);"></div>
        </div>
    </div>

    <script>
        const trans = {
            ar: {
                appTitle: 'Ø­Ø§ÙØ¸', subtitle: 'Ø±Ø­Ù„Ø© Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…', langBtn: 'English',
                labelPages: 'ØµÙØ­Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©', labelJuz: 'Ø£Ø¬Ø²Ø§Ø¡ Ù…ÙƒØªÙ…Ù„Ø©', labelStreak: 'Ø£ÙŠØ§Ù… Ù…ØªØªØ§Ù„ÙŠØ©',
                labelProgress: 'Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²', tabToday: 'Ø§Ù„ÙŠÙˆÙ…', tabJuz: 'Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡',
                tabHistory: 'Ø§Ù„Ø³Ø¬Ù„', tabStats: 'Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª', tabProfile: 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ',
                btnSave: 'Ø­ÙØ¸ Ø§Ù„ÙŠÙˆÙ…', labelNewPages: 'Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©',
                labelNewQuality: 'Ø¬ÙˆØ¯Ø© Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙŠØ¯', labelReviewPages: 'ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
                labelReviewQuality: 'Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', labelNotes: 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ÙŠÙˆÙ…',
                placeholderNewPages: 'Ù…Ø«Ø§Ù„: 1-3ØŒ 5', placeholderReviewPages: 'Ù…Ø«Ø§Ù„: 10-15',
                placeholderNotes: 'Ø¢ÙŠØ§Øª ØµØ¹Ø¨Ø©ØŒ Ø¥Ù†Ø¬Ø§Ø²Ø§ØªØŒ Ø£Ùˆ Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª...',
                statsTitle: 'Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…ÙØµÙ„Ø©', labelJuzStatus: 'Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø²Ø¡',
                labelJuzPages: 'Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© (Ù…Ù† 20)', labelJuzStart: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡',
                labelJuzEnd: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØªÙ…Ø§Ù…', labelJuzNotes: 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª',
                placeholderJuzNotes: 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡...', btnJuzSave: 'Ø­ÙØ¸', btnJuzCancel: 'Ø¥Ù„ØºØ§Ø¡',
                statusNotStarted: 'Ù„Ù… ÙŠØ¨Ø¯Ø£', statusInProgress: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸', statusCompleted: 'Ù…ÙƒØªÙ…Ù„',
                emptyHistory: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ø¨Ø¹Ø¯. Ø§Ø¨Ø¯Ø£ Ø¨ØªØ³Ø¬ÙŠÙ„ ÙŠÙˆÙ…Ùƒ Ø§Ù„Ø£ÙˆÙ„!',
                newMemorization: 'Ø­ÙØ¸ Ø¬Ø¯ÙŠØ¯', review: 'Ù…Ø±Ø§Ø¬Ø¹Ø©', notes: 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª', pages: 'ØµÙØ­Ø§Øª',
                rating: 'ØªÙ‚ÙŠÙŠÙ…', totalDays: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„', avgNewQuality: 'Ù…ØªÙˆØ³Ø· Ø¬ÙˆØ¯Ø© Ø§Ù„Ø­ÙØ¸',
                avgReviewQuality: 'Ù…ØªÙˆØ³Ø· Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', juzInProgress: 'Ø£Ø¬Ø²Ø§Ø¡ Ù‚ÙŠØ¯ Ø§Ù„Ø­ÙØ¸',
                saveSuccess: 'ØªÙ… Ø­ÙØ¸ Ø³Ø¬Ù„ Ø§Ù„ÙŠÙˆÙ… Ø¨Ù†Ø¬Ø§Ø­!', saveJuzSuccess: 'ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø²Ø¡ Ø¨Ù†Ø¬Ø§Ø­!',
                alertEnterPages: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ØµÙØ­Ø§Øª Ø§Ù„Ø­ÙØ¸ Ø£Ùˆ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', helpTitle: 'ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…',
                profileTitle: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', currentProfileName: 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø­Ø§Ù„ÙŠ',
                labelProfileSelect: 'Ø§Ø®ØªØ± Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ', labelNewProfile: 'Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø´Ø®ØµÙŠ Ø¬Ø¯ÙŠØ¯',
                placeholderNewProfile: 'Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯...', btnCreateProfile: 'Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù',
                profileActionsTitle: 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ù„Ù', btnExport: 'ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù', btnImport: 'Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù',
                btnRename: 'Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ©', btnDelete: 'Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù', profileInfoTitle: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù„Ù',
                profileCreated: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù„Ù', totalLogs: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª', lastActive: 'Ø¢Ø®Ø± Ù†Ø´Ø§Ø·',
                alertProfileName: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ù„Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ', alertProfileExists: 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„',
                profileCreatedSuccess: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø¨Ù†Ø¬Ø§Ø­!', profileSwitched: 'ØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù„Ù: ',
                confirmDelete: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„ÙØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.',
                cannotDeleteLast: 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù Ø§Ù„ÙˆØ­ÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ', profileDeleted: 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ',
                newProfileName: 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù…Ù„Ù:', profileRenamed: 'ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ© Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­',
                exportSuccess: 'ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­!', importSuccess: 'ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­!',
                importError: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù.'
            },
            en: {
                appTitle: 'Hafiz', subtitle: 'Your Quran Memorization Journey', langBtn: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
                labelPages: 'Pages Memorized', labelJuz: 'Juz Completed', labelStreak: 'Day Streak',
                labelProgress: 'Completion', tabToday: 'Today', tabJuz: 'Juz', tabHistory: 'History',
                tabStats: 'Statistics', tabProfile: 'Profile', btnSave: 'Save Today',
                labelNewPages: 'New Pages Memorized', labelNewQuality: 'New Memorization Quality',
                labelReviewPages: 'Review Pages', labelReviewQuality: 'Review Quality',
                labelNotes: 'Notes for Today', placeholderNewPages: 'e.g., 1-3, 5',
                placeholderReviewPages: 'e.g., 10-15', placeholderNotes: 'Difficult verses, achievements...',
                statsTitle: 'Detailed Statistics', labelJuzStatus: 'Juz Status',
                labelJuzPages: 'Pages Memorized (out of 20)', labelJuzStart: 'Start Date',
                labelJuzEnd: 'Completion Date', labelJuzNotes: 'Notes',
                placeholderJuzNotes: 'Notes about this Juz...', btnJuzSave: 'Save', btnJuzCancel: 'Cancel',
                statusNotStarted: 'Not Started', statusInProgress: 'In Progress', statusCompleted: 'Completed',
                emptyHistory: 'No history yet. Start by logging your first day!',
                newMemorization: 'New Memorization', review: 'Review', notes: 'Notes', pages: 'pages',
                rating: 'rating', totalDays: 'Total Days Logged', avgNewQuality: 'Avg New Quality',
                avgReviewQuality: 'Avg Review Quality', juzInProgress: 'Juz In Progress',
                saveSuccess: 'Today\'s log saved successfully!', saveJuzSuccess: 'Juz data saved successfully!',
                alertEnterPages: 'Please enter memorization or review pages', helpTitle: 'How to Use',
                profileTitle: 'Profile Management', currentProfileName: 'Current Profile',
                labelProfileSelect: 'Select Profile', labelNewProfile: 'Create New Profile',
                placeholderNewProfile: 'New profile name...', btnCreateProfile: 'Create Profile',
                profileActionsTitle: 'Profile Actions', btnExport: 'Export Profile', btnImport: 'Import Profile',
                btnRename: 'Rename', btnDelete: 'Delete Profile', profileInfoTitle: 'Profile Information',
                profileCreated: 'Created', totalLogs: 'Total Logs', lastActive: 'Last Active',
                alertProfileName: 'Please enter a profile name', alertProfileExists: 'Profile already exists',
                profileCreatedSuccess: 'Profile created successfully!', profileSwitched: 'Switched to profile: ',
                confirmDelete: 'Are you sure you want to delete this profile? This action cannot be undone.',
                cannotDeleteLast: 'Cannot delete the last remaining profile', profileDeleted: 'Profile deleted',
                newProfileName: 'Enter new profile name:', profileRenamed: 'Profile renamed successfully',
                exportSuccess: 'Profile exported successfully!', importSuccess: 'Profile imported successfully!',
                importError: 'Error importing profile. Please check the file.'
            }
        };

        let profiles = {}, currentProfile = 'default';
        let data = {
            logs: [], juz: {},
            settings: { newRating: 0, reviewRating: 0, language: 'ar' },
            metadata: { created: new Date().toISOString(), lastModified: new Date().toISOString() }
        };
        let currentJuz = null;

        const juzNames = {
            ar: ['Ø¢Ù„Ù… (Ø§Ù„ÙØ§ØªØ­Ø© - Ø§Ù„Ø¨Ù‚Ø±Ø©)', 'Ø³ÙÙŠÙÙ‚ÙÙˆÙ„Ù (Ø§Ù„Ø¨Ù‚Ø±Ø©)', 'ØªÙÙ„Ù’ÙƒÙ Ø§Ù„Ø±ÙÙ‘Ø³ÙÙ„Ù (Ø§Ù„Ø¨Ù‚Ø±Ø© - Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†)',
                'Ù„ÙÙ†Ù’ ØªÙÙ†ÙØ§Ù„ÙÙˆØ§ (Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù† - Ø§Ù„Ù†Ø³Ø§Ø¡)', 'ÙˆÙØ§Ù„Ù’Ù…ÙØ­Ù’ØµÙÙ†ÙØ§ØªÙ (Ø§Ù„Ù†Ø³Ø§Ø¡)', 'Ù„ÙØ§ ÙŠÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù„ÙÙ‘Ù‡Ù (Ø§Ù„Ù†Ø³Ø§Ø¡ - Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©)',
                'ÙˆÙØ¥ÙØ°ÙØ§ Ø³ÙÙ…ÙØ¹ÙÙˆØ§ (Ø§Ù„Ù…Ø§Ø¦Ø¯Ø© - Ø§Ù„Ø£Ù†Ø¹Ø§Ù…)', 'ÙˆÙÙ„ÙÙˆÙ’ Ø£ÙÙ†ÙÙ‘Ù†ÙØ§ (Ø§Ù„Ø£Ù†Ø¹Ø§Ù… - Ø§Ù„Ø£Ø¹Ø±Ø§Ù)', 'Ù‚ÙØ§Ù„Ù Ø§Ù„Ù’Ù…ÙÙ„ÙØ£Ù (Ø§Ù„Ø£Ø¹Ø±Ø§Ù - Ø§Ù„Ø£Ù†ÙØ§Ù„)',
                'ÙˆÙØ§Ø¹Ù’Ù„ÙÙ…ÙÙˆØ§ (Ø§Ù„Ø£Ù†ÙØ§Ù„ - Ø§Ù„ØªÙˆØ¨Ø©)', 'ÙŠÙØªÙØ¹ÙØ°ÙÙ‘Ø±ÙÙˆÙ†Ù (Ø§Ù„ØªÙˆØ¨Ø© - Ù‡ÙˆØ¯)', 'ÙˆÙÙ…ÙØ§ Ù…ÙÙ†Ù’ Ø¯ÙØ¢Ø¨ÙÙ‘Ø©Ù (Ù‡ÙˆØ¯ - ÙŠÙˆØ³Ù)',
                'ÙˆÙÙ…ÙØ§ Ø£ÙØ¨ÙØ±ÙÙ‘Ø¦Ù (ÙŠÙˆØ³Ù - Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…)', 'Ø±ÙØ¨ÙÙ…ÙØ§ (Ø§Ù„Ø­Ø¬Ø± - Ø§Ù„Ù†Ø­Ù„)', 'Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ (Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡ - Ø§Ù„ÙƒÙ‡Ù)',
                'Ù‚ÙØ§Ù„Ù Ø£ÙÙ„ÙÙ…Ù’ (Ø§Ù„ÙƒÙ‡Ù - Ø·Ù‡)', 'Ø§Ù‚Ù’ØªÙØ±ÙØ¨Ù (Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡ - Ø§Ù„Ø­Ø¬)', 'Ù‚ÙØ¯Ù’ Ø£ÙÙÙ’Ù„ÙØ­Ù (Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ† - Ø§Ù„ÙØ±Ù‚Ø§Ù†)',
                'ÙˆÙÙ‚ÙØ§Ù„Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù (Ø§Ù„ÙØ±Ù‚Ø§Ù† - Ø§Ù„Ù†Ù…Ù„)', 'Ø£ÙÙ…ÙÙ‘Ù†Ù’ Ø®ÙÙ„ÙÙ‚Ù (Ø§Ù„Ù†Ù…Ù„ - Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª)', 'Ø§ÙØªÙ’Ù„Ù Ù…ÙØ§ Ø£ÙÙˆØ­ÙÙŠÙ (Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª - Ø§Ù„Ø£Ø­Ø²Ø§Ø¨)',
                'ÙˆÙÙ…ÙÙ†Ù’ ÙŠÙÙ‚Ù’Ù†ÙØªÙ’ (Ø§Ù„Ø£Ø­Ø²Ø§Ø¨ - ÙŠØ³)', 'ÙˆÙØ£ÙÙ†Ø²ÙÙ„Ù’Ù†ÙØ§ (ÙŠØ³ - Ø§Ù„Ø²Ù…Ø±)', 'ÙÙÙ…ÙÙ†Ù’ Ø£ÙØ¸Ù’Ù„ÙÙ…Ù (Ø§Ù„Ø²Ù…Ø± - ÙØµÙ„Øª)',
                'Ø¥ÙÙ„ÙÙŠÙ’Ù‡Ù ÙŠÙØ±ÙØ¯ÙÙ‘ (ÙØµÙ„Øª - Ø§Ù„Ø¬Ø§Ø«ÙŠØ©)', 'Ø­ÙØ§ Ù…ÙÙŠÙ…Ù’ (Ø§Ù„Ø£Ø­Ù‚Ø§Ù - Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª)', 'Ù‚ÙØ§Ù„Ù ÙÙÙ…ÙØ§ Ø®ÙØ·Ù’Ø¨ÙÙƒÙÙ…Ù’ (Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª - Ø§Ù„Ø­Ø¯ÙŠØ¯)',
                'Ù‚ÙØ¯Ù’ Ø³ÙÙ…ÙØ¹Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù (Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø© - Ø§Ù„ØªØ­Ø±ÙŠÙ…)', 'ØªÙØ¨ÙØ§Ø±ÙÙƒÙ Ø§Ù„ÙÙ‘Ø°ÙÙŠ (Ø§Ù„Ù…Ù„Ùƒ - Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª)', 'Ø¹ÙÙ…ÙÙ‘ ÙŠÙØªÙØ³ÙØ§Ø¡ÙÙ„ÙÙˆÙ†Ù (Ø§Ù„Ù†Ø¨Ø£ - Ø§Ù„Ù†Ø§Ø³)'],
            en: ['Alif Lam Meem (Al-Fatiha - Al-Baqarah)', 'Sayaqool (Al-Baqarah)', 'Tilkal Rusul (Al-Baqarah - Al-Imran)',
                'Lan Tana Loo (Al-Imran - An-Nisa)', 'Wal Mohsanat (An-Nisa)', 'La Yuhibbullah (An-Nisa - Al-Ma\'idah)',
                'Wa Iza Samiu (Al-Ma\'idah - Al-An\'am)', 'Wa Lau Annana (Al-An\'am - Al-A\'raf)', 'Qalal Malao (Al-A\'raf - Al-Anfal)',
                'Wa A\'lamu (Al-Anfal - At-Tauba)', 'Yatazeroon (At-Tauba - Hud)', 'Wa Mamin Da\'abat (Hud - Yusuf)',
                'Wa Ma Ubrioo (Yusuf - Ibrahim)', 'Rubama (Al-Hijr - An-Nahl)', 'Subhanallazi (Al-Isra - Al-Kahf)',
                'Qal Alam (Al-Kahf - Ta-Ha)', 'Aqtarabo (Al-Anbiyaa - Al-Hajj)', 'Qadd Aflaha (Al-Muminun - Al-Furqan)',
                'Wa Qalallazina (Al-Furqan - An-Naml)', 'A\'man Khalaq (An-Naml - Al-Ankabut)', 'Utlu Ma Oohi (Al-Ankabut - Al-Azhab)',
                'Wa Manyaqnut (Al-Azhab - Ya-Sin)', 'Wa Anzalna (Ya-Sin - Az-Zumar)', 'Faman Azlam (Az-Zumar - Fussilat)',
                'Elahe Yuruddo (Fussilat - Al-Jasiyah)', 'Ha\'a Meem (Al-Ahqaf - Az-Dhariyat)', 'Qala Fama Khatbukum (Az-Dhariyat - Al-Hadid)',
                'Qadd Sami Allah (Al-Mujadilah - At-Tahrim)', 'Tabarakallazi (Al-Mulk - Al-Mursalat)', 'Amma Yatasa\'aloon (An-Naba - An-Nas)']
        };

        function init() {
            loadProfiles(); loadData(); applyLanguage(); updateStats();
            displayJuz(); displayHistory(); updateCurrentDate(); updateProfileInfo();
        }

        function loadProfiles() {
            const saved = localStorage.getItem('quranTrackerProfiles');
            if (saved) profiles = JSON.parse(saved);
            if (Object.keys(profiles).length === 0) {
                profiles['default'] = {
                    name: 'Default Profile',
                    data: { logs: [], juz: {},
                        settings: { newRating: 0, reviewRating: 0, language: 'ar' },
                        metadata: { created: new Date().toISOString(), lastModified: new Date().toISOString() }
                    }
                };
                saveProfiles();
            }
            const savedCurrent = localStorage.getItem('quranTrackerCurrentProfile');
            currentProfile = (savedCurrent && profiles[savedCurrent]) ? savedCurrent : Object.keys(profiles)[0];
            updateProfileSelector();
        }

        function saveProfiles() {
            localStorage.setItem('quranTrackerProfiles', JSON.stringify(profiles));
            localStorage.setItem('quranTrackerCurrentProfile', currentProfile);
        }

        function updateProfileSelector() {
            const select = document.getElementById('profileSelect');
            select.innerHTML = '';
            Object.keys(profiles).forEach(key => {
                const option = document.createElement('option');
                option.value = key; option.textContent = profiles[key].name;
                if (key === currentProfile) option.selected = true;
                select.appendChild(option);
            });
        }

        function createProfile() {
            const t = trans[data.settings.language];
            const name = document.getElementById('newProfileName').value.trim();
            if (!name) { alert(t.alertProfileName); return; }
            const key = 'profile_' + Date.now();
            profiles[key] = {
                name: name,
                data: { logs: [], juz: {},
                    settings: { newRating: 0, reviewRating: 0, language: data.settings.language },
                    metadata: { created: new Date().toISOString(), lastModified: new Date().toISOString() }
                }
            };
            saveProfiles(); updateProfileSelector();
            document.getElementById('newProfileName').value = '';
            alert(t.profileCreatedSuccess);
        }

        function switchProfile() {
            const t = trans[data.settings.language];
            const newProfile = document.getElementById('profileSelect').value;
            profiles[currentProfile].data = JSON.parse(JSON.stringify(data));
            profiles[currentProfile].data.metadata.lastModified = new Date().toISOString();
            currentProfile = newProfile; loadData(); saveProfiles();
            updateStats(); displayJuz(); displayHistory(); updateProfileInfo();
            alert(t.profileSwitched + profiles[currentProfile].name);
        }

        function deleteProfile() {
            const t = trans[data.settings.language];
            if (Object.keys(profiles).length === 1) { alert(t.cannotDeleteLast); return; }
            if (!confirm(t.confirmDelete)) return;
            delete profiles[currentProfile];
            currentProfile = Object.keys(profiles)[0];
            saveProfiles(); loadData(); updateProfileSelector();
            updateStats(); displayJuz(); displayHistory(); updateProfileInfo();
            alert(t.profileDeleted);
        }

        function renameProfile() {
            const t = trans[data.settings.language];
            const newName = prompt(t.newProfileName, profiles[currentProfile].name);
            if (newName && newName.trim()) {
                profiles[currentProfile].name = newName.trim();
                saveProfiles(); updateProfileSelector(); updateProfileInfo();
                alert(t.profileRenamed);
            }
        }

        function exportProfile() {
            const t = trans[data.settings.language];
            const exportData = {
                profileName: profiles[currentProfile].name,
                data: profiles[currentProfile].data,
                exportDate: new Date().toISOString(),
                appVersion: '1.0'
            };
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `hafiz_${profiles[currentProfile].name}_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a); a.click(); document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert(t.exportSuccess);
        }

        function importProfile() { document.getElementById('importFileInput').click(); }

        function handleImportFile(event) {
            const t = trans[data.settings.language];
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    if (!imported.data || !imported.profileName) throw new Error('Invalid file');
                    const key = 'profile_' + Date.now();
                    profiles[key] = { name: imported.profileName + ' (imported)', data: imported.data };
                    saveProfiles(); updateProfileSelector(); alert(t.importSuccess);
                } catch (error) { alert(t.importError); }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function updateProfileInfo() {
            const t = trans[data.settings.language];
            const info = document.getElementById('profileInfo');
            const profile = profiles[currentProfile];
            const created = new Date(profile.data.metadata.created).toLocaleDateString(
                data.settings.language === 'ar' ? 'ar-SA' : 'en-US',
                { year: 'numeric', month: 'long', day: 'numeric' }
            );
            const lastModified = profile.data.metadata.lastModified ?
                new Date(profile.data.metadata.lastModified).toLocaleDateString(
                    data.settings.language === 'ar' ? 'ar-SA' : 'en-US',
                    { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' }
                ) : created;
            info.innerHTML = `
                <div style="margin-bottom: 10px;"><strong>${t.profileCreated}:</strong> ${created}</div>
                <div style="margin-bottom: 10px;"><strong>${t.lastActive}:</strong> ${lastModified}</div>
                <div style="margin-bottom: 10px;"><strong>${t.totalLogs}:</strong> ${profile.data.logs.length}</div>
            `;
            document.getElementById('currentProfileName').textContent = profile.name;
        }

        function loadData() {
            if (profiles[currentProfile]) data = JSON.parse(JSON.stringify(profiles[currentProfile].data));
            if (!data.settings) data.settings = { newRating: 0, reviewRating: 0, language: 'ar' };
            if (!data.metadata) data.metadata = { created: new Date().toISOString(), lastModified: new Date().toISOString() };
            if (Object.keys(data.juz).length === 0) {
                for (let i = 1; i <= 30; i++) {
                    data.juz[i] = { status: 'not-started', pages: 0, startDate: null, endDate: null, notes: '' };
                }
            }
        }

        function saveData() {
            data.metadata.lastModified = new Date().toISOString();
            profiles[currentProfile].data = JSON.parse(JSON.stringify(data));
            saveProfiles();
        }

        function toggleLanguage() {
            data.settings.language = data.settings.language === 'ar' ? 'en' : 'ar';
            saveData(); applyLanguage();
        }

        function applyLanguage() {
            const lang = data.settings.language, t = trans[lang];
            document.documentElement.lang = lang;
            document.documentElement.dir = document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';
            Object.keys(t).forEach(key => {
                const el = document.getElementById(key);
                if (el) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.placeholder = t[key];
                    else el.textContent = t[key];
                }
            });
            const statusSelect = document.getElementById('juzStatus');
            if (statusSelect) {
                statusSelect.options[0].text = t.statusNotStarted;
                statusSelect.options[1].text = t.statusInProgress;
                statusSelect.options[2].text = t.statusCompleted;
            }
            displayJuz(); displayHistory(); updateCurrentDate(); updateProfileInfo();
        }

        const helpDocs = {
            ar: `
                <h3 style="color: var(--gold); margin: 25px 0 15px;">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø­Ø§ÙØ¸! ğŸŒ™</h3>
                <p>ØªØ·Ø¨ÙŠÙ‚ Ø­Ø§ÙØ¸ Ù‡Ùˆ Ø±ÙÙŠÙ‚Ùƒ ÙÙŠ Ø±Ø­Ù„Ø© Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…. ÙŠØ³Ø§Ø¹Ø¯Ùƒ Ø¹Ù„Ù‰ ØªØªØ¨Ø¹ ØªÙ‚Ø¯Ù…Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØŒ Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¬Ø²Ø§Ø¦ÙƒØŒ ÙˆÙ…Ø±Ø§Ù‚Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙƒ.</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h4>
                <p>ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©ØŒ Ø³ØªØ¬Ø¯ Ø£Ø±Ø¨Ø¹ Ø¨Ø·Ø§Ù‚Ø§Øª ØªØ¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙƒ:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>ØµÙØ­Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©:</strong> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„ØªÙŠ Ø­ÙØ¸ØªÙ‡Ø§ Ø¹Ø¨Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡</li>
                    <li><strong>Ø£Ø¬Ø²Ø§Ø¡ Ù…ÙƒØªÙ…Ù„Ø©:</strong> Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„ØªÙŠ Ø£ØªÙ…Ù…Øª Ø­ÙØ¸Ù‡Ø§ (ÙƒÙ„ Ø¬Ø²Ø¡ 20 ØµÙØ­Ø©)</li>
                    <li><strong>Ø£ÙŠØ§Ù… Ù…ØªØªØ§Ù„ÙŠØ©:</strong> Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªÙˆØ§ØµÙ„Ø© Ø§Ù„ØªÙŠ Ø³Ø¬Ù„Øª ÙÙŠÙ‡Ø§ Ø­ÙØ¸Ùƒ</li>
                    <li><strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²:</strong> Ù†Ø³Ø¨ØªÙƒ Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù…Ù† Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… (604 ØµÙØ­Ø©)</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„ÙŠÙˆÙ…"</h4>
                <p>Ù‡Ù†Ø§ ØªØ³Ø¬Ù„ Ø­ÙØ¸Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</strong> Ø£Ø¯Ø®Ù„ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„ØªÙŠ Ø­ÙØ¸ØªÙ‡Ø§ Ø§Ù„ÙŠÙˆÙ… (Ù…Ø«Ø§Ù„: "1-3" Ø£Ùˆ "5ØŒ 7-9")</li>
                    <li><strong>Ø¬ÙˆØ¯Ø© Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙŠØ¯:</strong> Ù‚ÙŠÙ‘Ù… Ù…Ø¯Ù‰ Ø¥ØªÙ‚Ø§Ù†Ùƒ Ù„Ù„Ø­ÙØ¸ Ù…Ù† 1-5 Ù†Ø¬ÙˆÙ…</li>
                    <li><strong>ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:</strong> Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„ØªÙŠ Ø±Ø§Ø¬Ø¹ØªÙ‡Ø§ Ù…Ù† Ø­ÙØ¸Ùƒ Ø§Ù„Ø³Ø§Ø¨Ù‚</li>
                    <li><strong>Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:</strong> Ù‚ÙŠÙ‘Ù… Ù…Ø¯Ù‰ Ø§Ø­ØªÙØ§Ø¸Ùƒ Ø¨Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ù‚Ø¯ÙŠÙ…</li>
                    <li><strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ÙŠÙˆÙ…:</strong> Ø³Ø¬Ù„ Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø¢ÙŠØ§Øª ØµØ¹Ø¨Ø©ØŒ Ø¥Ù†Ø¬Ø§Ø²Ø§ØªØŒ ØªØ£Ù…Ù„Ø§Øª)</li>
                </ul>
                <p><strong>ğŸ’¡ Ù†ØµÙŠØ­Ø©:</strong> Ø§Ø¶ØºØ· "Ø­ÙØ¸ Ø§Ù„ÙŠÙˆÙ…" Ù„ØªØ³Ø¬ÙŠÙ„ Ø¥Ø¯Ø®Ø§Ù„Ùƒ. Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„!</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“š ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡"</h4>
                <p>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠÙ† Ø¨Ø´ÙƒÙ„ ÙØ±Ø¯ÙŠ:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø¬Ø²Ø¡</strong> Ù„ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„</li>
                    <li><strong>Ø­Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„Ø©:</strong> Ù„Ù… ÙŠØ¨Ø¯Ø£ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸ØŒ Ø£Ùˆ Ù…ÙƒØªÙ…Ù„</li>
                    <li><strong>ØªØªØ¨Ø¹ Ø§Ù„ØµÙØ­Ø§Øª:</strong> Ø³Ø¬Ù„ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù…Ù† 20</li>
                    <li><strong>Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®:</strong> Ø³Ø¬Ù„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡ ÙˆØ§Ù„Ø¥ØªÙ…Ø§Ù…</li>
                    <li><strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ©:</strong> Ø£Ø¶Ù Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù† Ø§Ù„Ø¬Ø²Ø¡</li>
                </ul>
                <p><strong>ğŸ’¡ Ù†ØµÙŠØ­Ø©:</strong> Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© ØªØ¸Ù‡Ø± Ø¨Ù„ÙˆÙ† Ù…Ù…ÙŠØ²!</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“– ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ø³Ø¬Ù„"</h4>
                <p>Ø±Ø§Ø¬Ø¹ Ø¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø¨ØªØ±ØªÙŠØ¨ Ø²Ù…Ù†ÙŠ. ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¤ÙŠØ©:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„ÙƒØ§Ù…Ù„ Ù„ÙƒÙ„ Ø¥Ø¯Ø®Ø§Ù„</li>
                    <li>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</li>
                    <li>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù†Ø¬Ù…ÙŠØ©</li>
                    <li>Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“ˆ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª"</h4>
                <p>Ø´Ø§Ù‡Ø¯ ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…ÙØµÙ„Ø© Ù„Ø£Ø¯Ø§Ø¦Ùƒ:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> ÙƒÙ… ÙŠÙˆÙ…Ø§Ù‹ Ø³Ø¬Ù„Øª ÙÙŠÙ‡ Ø­ÙØ¸Ùƒ</li>
                    <li><strong>Ù…ØªÙˆØ³Ø· Ø¬ÙˆØ¯Ø© Ø§Ù„Ø­ÙØ¸:</strong> Ù…Ø¹Ø¯Ù„ ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙƒ Ù„Ù„Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙŠØ¯</li>
                    <li><strong>Ù…ØªÙˆØ³Ø· Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:</strong> Ù…Ø¹Ø¯Ù„ ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙƒ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</li>
                    <li><strong>Ø£Ø¬Ø²Ø§Ø¡ Ù‚ÙŠØ¯ Ø§Ù„Ø­ÙØ¸:</strong> Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„ØªÙŠ ØªØ¹Ù…Ù„ Ø¹Ù„ÙŠÙ‡Ø§ Ø­Ø§Ù„ÙŠØ§Ù‹</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ‘¤ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ"</h4>
                <p>Ø¥Ø¯Ø§Ø±Ø© Ù…Ù„ÙØ§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯:</strong> Ù„ÙƒÙ„ ÙØ±Ø¯ Ù…Ù† Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ù…Ù„ÙÙ‡ Ø§Ù„Ø®Ø§Øµ</li>
                    <li><strong>Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª:</strong> Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©</li>
                    <li><strong>ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù:</strong> Ø­Ù…Ù‘Ù„ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨ØµÙŠØºØ© JSON</li>
                    <li><strong>Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù:</strong> Ø§Ø±ÙØ¹ Ù…Ù„ÙØ§Ù‹ Ù…Ø­ÙÙˆØ¸Ø§Ù‹ Ù…Ø³Ø¨Ù‚Ø§Ù‹</li>
                    <li><strong>Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ©:</strong> ØºÙŠÙ‘Ø± Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø­Ø§Ù„ÙŠ</li>
                    <li><strong>Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù:</strong> Ø§Ø­Ø°Ù Ù…Ù„ÙØ§Ù‹ (Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹!)</li>
                </ul>
                <p><strong>âš ï¸ Ù…Ù‡Ù…:</strong> ÙƒÙ„ Ù…Ù„Ù Ù„Ù‡ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ø§Ù„Ù…Ø³ØªÙ‚Ù„Ø© ØªÙ…Ø§Ù…Ø§Ù‹!</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ’¾ ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
                <p>Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙŠ Ù…ØªØµÙØ­Ùƒ:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>âœ… Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø®Ø§ØµØ© ÙˆØªØ¨Ù‚Ù‰ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ</li>
                    <li>âœ… ÙŠØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„</li>
                    <li>âš ï¸ Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØµÙØ­ Ø³ÙŠØ­Ø°Ù Ø³Ø¬Ù„Ø§ØªÙƒ</li>
                    <li>âš ï¸ ÙƒÙ„ Ù…ØªØµÙØ­/Ø¬Ù‡Ø§Ø² Ù„Ù‡ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†ÙØµÙ„Ø©</li>
                    <li>ğŸ’¡ ØµØ¯Ù‘Ø± Ù…Ù„ÙÙƒ Ø¨Ø§Ù†ØªØ¸Ø§Ù… ÙƒÙ†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©!</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“± Ø§Ù„ØªØ«Ø¨ÙŠØª ÙƒØªØ·Ø¨ÙŠÙ‚</h4>
                <p>ÙŠÙ…ÙƒÙ†Ùƒ ØªØ«Ø¨ÙŠØª Ø­Ø§ÙØ¸ ÙƒØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Ø§Ù„Ø¬ÙˆØ§Ù„:</strong> Ø§Ø¨Ø­Ø« Ø¹Ù† "Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØµÙØ­</li>
                    <li><strong>Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨:</strong> Ø§Ø¶ØºØ· Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØ«Ø¨ÙŠØª ÙÙŠ Ø´Ø±ÙŠØ· Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ØªØµÙØ­</li>
                    <li>Ø¨Ø¹Ø¯ Ø§Ù„ØªØ«Ø¨ÙŠØªØŒ ÙŠØ¹Ù…Ù„ ÙƒØªØ·Ø¨ÙŠÙ‚ Ø£ØµÙ„ÙŠ Ù…Ø¹ Ø¯Ø¹Ù… ÙˆØ¶Ø¹ Ø¹Ø¯Ù… Ø§Ù„Ø§ØªØµØ§Ù„</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ù†Ø¬Ø§Ø­</h4>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>ğŸ“… Ø³Ø¬Ù„ ÙŠÙˆÙ…ÙŠØ§Ù‹ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø³Ù„Ø³Ù„ØªÙƒ ÙˆØ±Ø¤ÙŠØ© ØªÙ‚Ø¯Ù… Ù…Ø³ØªÙ…Ø±</li>
                    <li>â­ ÙƒÙ† ØµØ§Ø¯Ù‚Ø§Ù‹ ÙÙŠ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ù…Ø²ÙŠØ¯Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„</li>
                    <li>ğŸ“ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„ØµØ¹Ø¨Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø±ÙƒØ²Ø©</li>
                    <li>ğŸ¯ Ø­Ø¯Ù‘Ø« Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø¨Ø§Ù†ØªØ¸Ø§Ù… Ù„Ø±Ø¤ÙŠØ© ØªÙ‚Ø¯Ù… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</li>
                    <li>ğŸ“Š Ø±Ø§Ø¬Ø¹ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„ Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹ Ù„Ù„ØªØ£Ù…Ù„ ÙÙŠ Ø±Ø­Ù„ØªÙƒ</li>
                    <li>ğŸ’¾ ØµØ¯Ù‘Ø± Ù…Ù„ÙÙƒ ÙƒÙ„ Ø´Ù‡Ø± ÙƒÙ†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</li>
                    <li> Ø£Ù†Ø´Ø¦ Ù…Ù„ÙØ§Øª Ù…Ù†ÙØµÙ„Ø© Ù„Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸŒ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡</h4>
                <p>Ø´Ø§Ø±Ùƒ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ! Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø´Ø®Øµ Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø´ÙƒÙ„ Ù…Ù†ÙØµÙ„ ÙÙŠ Ù…ØªØµÙØ­Ù‡ Ø§Ù„Ø®Ø§ØµØŒ Ù„Ø°Ø§ ÙŠÙ…ÙƒÙ† Ù„Ù„Ø¬Ù…ÙŠØ¹ ØªØªØ¨Ø¹ ØªÙ‚Ø¯Ù…Ù‡Ù… Ø§Ù„ÙØ±Ø¯ÙŠ.</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ”„ ØªØµØ¯ÙŠØ± ÙˆØ§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
                <p><strong>Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ:</strong></p>
                <ol style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ"</li>
                    <li>Ø§Ø¶ØºØ· "ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù"</li>
                    <li>Ø³ÙŠØªÙ… ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù JSON ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ</li>
                    <li>Ø§Ø­ÙØ¸ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙÙŠ Ù…ÙƒØ§Ù† Ø¢Ù…Ù† (Ø³Ø­Ø§Ø¨Ø©ØŒ USBØŒ Ø¥Ù„Ø®)</li>
                </ol>
                <p><strong>Ù„Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©:</strong></p>
                <ol style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ"</li>
                    <li>Ø§Ø¶ØºØ· "Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù"</li>
                    <li>Ø§Ø®ØªØ± Ù…Ù„Ù JSON Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ù…Ø³Ø¨Ù‚Ø§Ù‹</li>
                    <li>Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©</li>
                </ol>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">â“ Ø£Ø³Ø¦Ù„Ø© Ø´Ø§Ø¦Ø¹Ø©</h4>
                <p><strong>Ø³: Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ø£Ø¬Ù‡Ø²Ø© Ù…ØªØ¹Ø¯Ø¯Ø©ØŸ</strong><br>
                Ø¬: Ù†Ø¹Ù…ØŒ Ù„ÙƒÙ† Ø¹Ù„ÙŠÙƒ ØªØµØ¯ÙŠØ± ÙˆØ§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù ÙŠØ¯ÙˆÙŠØ§Ù‹. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§ ØªØªØ²Ø§Ù…Ù† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</p>
                
                <p><strong>Ø³: Ù…Ø§Ø°Ø§ Ù„Ùˆ Ø£Ø±Ø¯Øª ØªØºÙŠÙŠØ± Ø§Ù„Ù…ØªØµÙØ­ØŸ</strong><br>
                Ø¬: ØµØ¯Ù‘Ø± Ù…Ù„ÙÙƒ Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ù‚Ø¯ÙŠÙ…ØŒ Ø«Ù… Ø§Ø³ØªÙˆØ±Ø¯Ù‡ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ø¬Ø¯ÙŠØ¯.</p>
                
                <p><strong>Ø³: Ù‡Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙŠ Ø¢Ù…Ù†Ø©ØŸ</strong><br>
                Ø¬: Ù†Ø¹Ù…! Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ ÙÙ‚Ø·. Ù„Ø§ ØªÙØ±Ø³Ù„ Ù„Ø£ÙŠ Ø®Ø§Ø¯Ù….</p>

                <p style="margin-top: 30px; text-align: center; color: var(--gold); font-size: 1.1rem;">
                    <strong>Ø¬Ø¹Ù„ Ø§Ù„Ù„Ù‡ Ø±Ø­Ù„Ø© Ø­ÙØ¸Ùƒ Ù…ÙŠØ³Ø±Ø© ÙˆØªÙ‚Ø¨Ù„ Ø¬Ù‡ÙˆØ¯Ùƒ ğŸ¤²</strong><br>
                    <span style="font-size: 0.9rem; color: var(--sage);">Ø¨Ø§Ø±Ùƒ Ø§Ù„Ù„Ù‡ ÙÙŠÙƒ ÙˆÙÙŠ Ø­ÙØ¸Ùƒ Ù„Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</span>
                </p>
            `,
            en: `
                <h3 style="color: var(--gold); margin: 25px 0 15px;">Welcome to Hafiz! ğŸŒ™</h3>
                <p>Hafiz is your companion in the journey of Quran memorization. It helps you track daily progress, manage your Juz, and monitor your achievements.</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“Š Main Dashboard</h4>
                <p>At the top of the page, you'll find four cards displaying your statistics:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Pages Memorized:</strong> Total pages you've memorized across all Juz</li>
                    <li><strong>Juz Completed:</strong> Number of complete Juz (each has 20 pages)</li>
                    <li><strong>Day Streak:</strong> Consecutive days you've logged your practice</li>
                    <li><strong>Completion:</strong> Your percentage toward completing the Quran (604 pages)</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“ "Today" Tab</h4>
                <p>Here you log your daily memorization:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>New Pages Memorized:</strong> Enter pages you memorized today (e.g., "1-3" or "5, 7-9")</li>
                    <li><strong>New Memorization Quality:</strong> Rate how well you memorized (1-5 stars)</li>
                    <li><strong>Review Pages:</strong> Pages you reviewed from previous memorization</li>
                    <li><strong>Review Quality:</strong> Rate how well you retained what you reviewed</li>
                    <li><strong>Notes for Today:</strong> Record any notes (difficult verses, achievements, reflections)</li>
                </ul>
                <p><strong>ğŸ’¡ Tip:</strong> Click "Save Today" to record your entry. It will appear in the History tab!</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“š "Juz" Tab</h4>
                <p>Manage your 30 Juz individually:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Click any Juz</strong> to open the details window</li>
                    <li><strong>Set Status:</strong> Not Started, In Progress, or Completed</li>
                    <li><strong>Track Pages:</strong> Record number of pages memorized out of 20</li>
                    <li><strong>Dates:</strong> Record start and completion dates</li>
                    <li><strong>Specific Notes:</strong> Add notes about the Juz</li>
                </ul>
                <p><strong>ğŸ’¡ Tip:</strong> Completed Juz appear with a distinctive color!</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“– "History" Tab</h4>
                <p>Review all your past daily logs in chronological order. You can see:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>Full date for each entry</li>
                    <li>Pages memorized and reviewed</li>
                    <li>Star ratings</li>
                    <li>Your daily notes</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“ˆ "Statistics" Tab</h4>
                <p>View detailed analytics of your performance:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Total Days Logged:</strong> How many days you've logged practice</li>
                    <li><strong>Avg New Quality:</strong> Average of your new memorization ratings</li>
                    <li><strong>Avg Review Quality:</strong> Average of your review ratings</li>
                    <li><strong>Juz In Progress:</strong> Number of Juz you're currently working on</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ‘¤ "Profile" Tab</h4>
                <p>Manage your multiple profiles:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Create New Profile:</strong> Each family member can have their own profile</li>
                    <li><strong>Switch Between Profiles:</strong> Select from dropdown menu</li>
                    <li><strong>Export Profile:</strong> Download a JSON backup file</li>
                    <li><strong>Import Profile:</strong> Upload a previously saved file</li>
                    <li><strong>Rename:</strong> Change the current profile name</li>
                    <li><strong>Delete Profile:</strong> Remove a profile (cannot be undone!)</li>
                </ul>
                <p><strong>âš ï¸ Important:</strong> Each profile has completely independent data!</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ’¾ Data Storage</h4>
                <p>All your data is saved locally in your browser:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>âœ… Your data is private and stays on your device</li>
                    <li>âœ… Works offline after first load</li>
                    <li>âš ï¸ Clearing browser data will delete your logs</li>
                    <li>âš ï¸ Each browser/device has separate data</li>
                    <li>ğŸ’¡ Export your profile regularly as backup!</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ“± Installing as an App</h4>
                <p>You can install Hafiz as an app on your device:</p>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li><strong>Mobile:</strong> Look for "Add to Home Screen" in your browser menu</li>
                    <li><strong>Desktop:</strong> Click the install icon in your browser's address bar</li>
                    <li>Once installed, it works like a native app with offline support</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ’¡ Tips for Success</h4>
                <ul style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>ğŸ“… Log daily to maintain your streak and see consistent progress</li>
                    <li>â­ Be honest with quality ratings to identify areas needing more work</li>
                    <li>ğŸ“ Use notes to record difficult verses for focused review</li>
                    <li>ğŸ¯ Update Juz status regularly to see your completion progress</li>
                    <li>ğŸ“Š Review the History tab weekly to reflect on your journey</li>
                    <li>ğŸ’¾ Export your profile monthly as backup</li>
                    <li> Create separate profiles for family members</li>
                </ul>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸŒ Sharing with Friends</h4>
                <p>Share the website URL with friends! Each person's data is stored separately in their own browser, so everyone can track their individual progress.</p>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">ğŸ”„ Export & Import Data</h4>
                <p><strong>To Backup:</strong></p>
                <ol style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>Go to "Profile" tab</li>
                    <li>Click "Export Profile"</li>
                    <li>A JSON file containing all your data will download</li>
                    <li>Save this file in a safe place (cloud, USB, etc.)</li>
                </ol>
                <p><strong>To Restore:</strong></p>
                <ol style="margin: 10px 0 15px 20px; color: var(--sage);">
                    <li>Go to "Profile" tab</li>
                    <li>Click "Import Profile"</li>
                    <li>Select the previously saved JSON file</li>
                    <li>A new profile will be created with the imported data</li>
                </ol>

                <h4 style="color: var(--gold-light); margin: 20px 0 10px;">â“ Frequently Asked Questions</h4>
                <p><strong>Q: Can I use the app on multiple devices?</strong><br>
                A: Yes, but you need to manually export and import the profile. Data doesn't sync automatically.</p>
                
                <p><strong>Q: What if I want to change browsers?</strong><br>
                A: Export your profile from the old browser, then import it in the new one.</p>
                
                <p><strong>Q: Is my data secure?</strong><br>
                A: Yes! All data is stored locally on your device only. Nothing is sent to any server.</p>

                <p style="margin-top: 30px; text-align: center; color: var(--gold); font-size: 1.1rem;">
                    <strong>May Allah make your memorization journey easy and accept your efforts ğŸ¤²</strong><br>
                    <span style="font-size: 0.9rem; color: var(--sage);">May Allah bless you in your Quran memorization</span>
                </p>
            `
        };

        function openHelp() {
            const lang = data.settings.language;
            document.getElementById('helpTitle').textContent = trans[lang].helpTitle;
            document.getElementById('helpContent').innerHTML = helpDocs[lang];
            document.getElementById('helpModal').classList.add('active');
        }

        function closeHelp() { document.getElementById('helpModal').classList.remove('active'); }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            ['todayTab', 'juzTab', 'historyTab', 'statsTab', 'profileTab'].forEach(t => 
                document.getElementById(t).style.display = 'none'
            );
            if (tab === 'today') document.getElementById('todayTab').style.display = 'block';
            else if (tab === 'juz') document.getElementById('juzTab').style.display = 'block';
            else if (tab === 'history') { document.getElementById('historyTab').style.display = 'block'; displayHistory(); }
            else if (tab === 'stats') { document.getElementById('statsTab').style.display = 'block'; displayDetailedStats(); }
            else if (tab === 'profile') { document.getElementById('profileTab').style.display = 'block'; updateProfileInfo(); }
        }

        function setRating(type, rating) {
            const container = document.getElementById(type + 'Rating');
            container.querySelectorAll('.star').forEach((star, index) => {
                if (index < rating) star.classList.add('active');
                else star.classList.remove('active');
            });
            data.settings[type + 'Rating'] = rating;
        }

        function saveLog() {
            const t = trans[data.settings.language];
            const newPages = document.getElementById('newPages').value;
            const reviewPages = document.getElementById('reviewPages').value;
            const notes = document.getElementById('notes').value;
            if (!newPages && !reviewPages) { alert(t.alertEnterPages); return; }
            const log = {
                date: new Date().toISOString(), newPages, newRating: data.settings.newRating,
                reviewPages, reviewRating: data.settings.reviewRating, notes
            };
            data.logs.unshift(log); saveData(); updateStats();
            document.getElementById('newPages').value = '';
            document.getElementById('reviewPages').value = '';
            document.getElementById('notes').value = '';
            document.querySelectorAll('.star').forEach(s => s.classList.remove('active'));
            data.settings.newRating = 0; data.settings.reviewRating = 0;
            alert(t.saveSuccess); displayHistory();
        }

        function updateStats() {
            let totalPages = 0, completedJuz = 0;
            Object.values(data.juz).forEach(juz => { 
                totalPages += juz.pages;
                if (juz.status === 'completed') completedJuz++;
            });
            let streak = calculateStreak();
            document.getElementById('totalPages').textContent = totalPages;
            document.getElementById('totalJuz').textContent = completedJuz;
            document.getElementById('currentStreak').textContent = streak;
            const progress = (totalPages / 604) * 100;
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            const circle = document.getElementById('progressCircle');
            const offset = 339.292 - (progress / 100) * 339.292;
            circle.style.strokeDashoffset = offset;
        }

        function calculateStreak() {
            if (data.logs.length === 0) return 0;
            let streak = 0;
            const today = new Date(); today.setHours(0, 0, 0, 0);
            for (let i = 0; i < data.logs.length; i++) {
                const logDate = new Date(data.logs[i].date); logDate.setHours(0, 0, 0, 0);
                const diffDays = Math.floor((today - logDate) / (1000 * 60 * 60 * 24));
                if (diffDays === streak) streak++; else break;
            }
            return streak;
        }

        function displayJuz() {
            const lang = data.settings.language, t = trans[lang];
            const grid = document.getElementById('juzGrid');
            grid.innerHTML = '';
            for (let i = 1; i <= 30; i++) {
                const juz = data.juz[i];
                const card = document.createElement('div');
                card.className = 'juz-card' + (juz.status === 'completed' ? ' completed' : '');
                card.onclick = () => openJuzModal(i);
                const statusText = {
                    'not-started': t.statusNotStarted,
                    'in-progress': t.statusInProgress,
                    'completed': t.statusCompleted
                };
                card.innerHTML = `
                    <div class="juz-number">${lang === 'ar' ? convertToArabicNumerals(i) : i}</div>
                    <div class="juz-name">${juzNames[lang][i-1]}</div>
                    <div class="juz-status">${statusText[juz.status]}</div>
                `;
                grid.appendChild(card);
            }
        }

        function convertToArabicNumerals(num) {
            const arabicNumerals = ['Ù ', 'Ù¡', 'Ù¢', 'Ù£', 'Ù¤', 'Ù¥', 'Ù¦', 'Ù§', 'Ù¨', 'Ù©'];
            return num.toString().split('').map(d => arabicNumerals[parseInt(d)]).join('');
        }

        function openJuzModal(juzNumber) {
            currentJuz = juzNumber;
            const juz = data.juz[juzNumber], lang = data.settings.language;
            document.getElementById('modalTitle').textContent = (lang === 'ar' ? 'Ø¬Ø²Ø¡ ' : 'Juz ') +
                (lang === 'ar' ? convertToArabicNumerals(juzNumber) : juzNumber);
            document.getElementById('juzStatus').value = juz.status;
            document.getElementById('juzPages').value = juz.pages;
            document.getElementById('juzStartDate').value = juz.startDate || '';
            document.getElementById('juzEndDate').value = juz.endDate || '';
            document.getElementById('juzNotes').value = juz.notes;
            document.getElementById('juzModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('juzModal').classList.remove('active');
            currentJuz = null;
        }

        function saveJuz() {
            if (!currentJuz) return;
            const t = trans[data.settings.language];
            data.juz[currentJuz] = {
                status: document.getElementById('juzStatus').value,
                pages: parseInt(document.getElementById('juzPages').value) || 0,
                startDate: document.getElementById('juzStartDate').value,
                endDate: document.getElementById('juzEndDate').value,
                notes: document.getElementById('juzNotes').value
            };
            saveData(); updateStats(); displayJuz(); closeModal();
            alert(t.saveJuzSuccess);
        }

        function displayHistory() {
            const lang = data.settings.language, t = trans[lang];
            const list = document.getElementById('historyList');
            if (data.logs.length === 0) {
                list.innerHTML = `<div class="empty-state"><p>${t.emptyHistory}</p></div>`;
                return;
            }
            list.innerHTML = data.logs.map(log => {
                const date = new Date(log.date);
                const formattedDate = date.toLocaleDateString(lang === 'ar' ? 'ar-SA' : 'en-US',
                    { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                let content = '';
                if (log.newPages) {
                    content += `<strong>${t.newMemorization}:</strong> ${log.newPages} ${t.pages}`;
                    if (log.newRating) content += ` (${t.rating}: ${'â˜…'.repeat(log.newRating)})`;
                    content += '<br>';
                }
                if (log.reviewPages) {
                    content += `<strong>${t.review}:</strong> ${log.reviewPages} ${t.pages}`;
                    if (log.reviewRating) content += ` (${t.rating}: ${'â˜…'.repeat(log.reviewRating)})`;
                    content += '<br>';
                }
                if (log.notes) content += `<strong>${t.notes}:</strong> ${log.notes}`;
                return `<div class="history-item">
                    <div class="history-date">${formattedDate}</div>
                    <div class="history-content">${content}</div>
                </div>`;
            }).join('');
        }

        function displayDetailedStats() {
            const lang = data.settings.language, t = trans[lang];
            const container = document.getElementById('detailedStats');
            let totalDays = data.logs.length;
            let avgNewQuality = 0, avgReviewQuality = 0, newCount = 0, reviewCount = 0;
            data.logs.forEach(log => {
                if (log.newRating > 0) { avgNewQuality += log.newRating; newCount++; }
                if (log.reviewRating > 0) { avgReviewQuality += log.reviewRating; reviewCount++; }
            });
            avgNewQuality = newCount > 0 ? (avgNewQuality / newCount).toFixed(1) : 0;
            avgReviewQuality = reviewCount > 0 ? (avgReviewQuality / reviewCount).toFixed(1) : 0;
            let juzInProgress = 0;
            Object.values(data.juz).forEach(juz => { if (juz.status === 'in-progress') juzInProgress++; });
            container.innerHTML = `<div class="stats-grid">
                <div class="stat-card"><div class="stat-number">${totalDays}</div><div class="stat-label">${t.totalDays}</div></div>
                <div class="stat-card"><div class="stat-number">${avgNewQuality}</div><div class="stat-label">${t.avgNewQuality}</div></div>
                <div class="stat-card"><div class="stat-number">${avgReviewQuality}</div><div class="stat-label">${t.avgReviewQuality}</div></div>
                <div class="stat-card"><div class="stat-number">${juzInProgress}</div><div class="stat-label">${t.juzInProgress}</div></div>
            </div>`;
        }

        function updateCurrentDate() {
            const lang = data.settings.language;
            const date = new Date();
            const formatted = date.toLocaleDateString(lang === 'ar' ? 'ar-SA' : 'en-US',
                { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            document.getElementById('currentDate').textContent = formatted;
        }

        document.getElementById('juzModal').addEventListener('click', (e) => {
            if (e.target.id === 'juzModal') closeModal();
        });
        document.getElementById('helpModal').addEventListener('click', (e) => {
            if (e.target.id === 'helpModal') closeHelp();
        });

        init();
    </script>
</body>
</html>
